<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Products Page</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
      }

      h1,
      h2 {
        text-align: center;
        color: #333;
      }

      .container {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        padding: 20px;
      }

      .product-card {
        background-color: white;
        border: 1px solid #ddd;
        border-radius: 5px;
        width: 250px;
        margin: 20px;
        padding: 15px;
        text-align: center;
        box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease-in-out;
      }

      .product-card:hover {
        transform: scale(1.05);
      }

      .product-card img {
        width: 100%;
        height: 200px;
        object-fit: cover;
        border-radius: 5px;
      }

      .product-card h3 {
        font-size: 20px;
        color: #333;
        margin: 10px 0;
      }

      .product-card p {
        font-size: 14px;
        color: #555;
        margin: 10px 0;
      }

      .price {
        font-size: 18px;
        font-weight: bold;
        color: #4caf50;
        margin: 10px 0;
      }

      .btn {
        background-color: #4caf50;
        color: white;
        padding: 12px;
        border: none;
        width: 100%;
        border-radius: 3px;
        cursor: pointer;
        font-size: 16px;
      }

      .btn:hover {
        background-color: #45a049;
      }

      .cart {
        display: flex;
        justify-content: flex-end;
        margin: 20px;
      }

      .cart-item {
        background-color: white;
        border: 1px solid #ddd;
        padding: 10px;
        margin-left: 10px;
        border-radius: 5px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        width: 200px;
        box-shadow: 0px 0px 5px rgba(0, 0, 0, 0.1);
      }

      .cart-item button {
        background-color: #ff5733;
        color: white;
        border: none;
        border-radius: 3px;
        cursor: pointer;
      }

      .cart-item button:hover {
        background-color: #e03e1b;
      }

      /* Checkout Button Styles */
      .checkout-btn {
        background-color: #4caf50; /* Green background */
        color: white; /* White text */
        font-size: 16px; /* Font size */
        padding: 15px 25px; /* Top-bottom and left-right padding */
        border: none; /* Remove border */
        border-radius: 5px; /* Rounded corners */
        cursor: pointer; /* Change cursor to pointer on hover */
        transition: all 0.3s ease; /* Smooth transition for hover effects */
        text-align: center; /* Center the text */
        display: inline-block; /* Make it inline */
        width: auto; /* Adjust width to the content */
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Light shadow for depth */
      }

      .checkout-btn:hover {
        background-color: #45a049;
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
      }

      .checkout-btn:focus {
        outline: none;
        box-shadow: 0 0 8px 2px rgba(76, 175, 80, 0.8);
      }

      .checkout-btn:disabled {
        background-color: #a5d6a7;
        cursor: not-allowed;
        box-shadow: none;
      }
    </style>
    <link
      rel="icon"
      href="./imagespexels-danny-meneses-340146-943096.jpg"
      type="image/x-icon"
    />
  </head>
  <body>
    <h1>Welcome to Our Store!</h1>
    <h2>Browse Our Products</h2>

    <div class="container">
      <div class="product-card">
        <img src="./images/Kona-Laptop-Table-02.webp" alt="table" />
        <h3>Adjustable Table for Laptop</h3>
        <p>
          Crafted from premium wood and sturdy materials, this table offers
          exceptional durability and stability for everyday use.
        </p>
        <div class="price">$19.99</div>
        <button
          class="btn"
          onclick="addToCart('Adjustable Table for Laptop', 19.99)"
        >
          Add to Cart
        </button>
      </div>

      <div class="product-card">
        <img src="./images/chair.webp" alt="chair" />
        <h3>Chair</h3>
        <p>
          This versatile chair is the perfect blend of comfort and style,
          designed to elevate any space with its sleek and modern look.
        </p>
        <div class="price">$29.99</div>
        <button class="btn" onclick="addToCart('Chair', 29.99)">
          Add to Cart
        </button>
      </div>

      <div class="product-card">
        <img src="./images/laptop-coffee.webp" alt="Laptop" />
        <h3>Apple Laptop</h3>
        <p>
          Enjoy vibrant colors, sharp details, and true-to-life visuals with the
          MacBook Pro's brilliant Retina display, perfect for creative work,
          movies, and photos.
        </p>
        <div class="price">$39.99</div>
        <button class="btn" onclick="addToCart('Apple Laptop', 39.99)">
          Add to Cart
        </button>
      </div>

      <div class="product-card">
        <img src="./images/elegant-smartphone.webp" alt="I-Phone" />
        <h3>Apple Smartphone</h3>
        <p>
          The Apple iPhone 15 brings together the latest technology and
          exceptional design to offer a truly revolutionary smartphone
          experience.
        </p>
        <div class="price">$49.99</div>
        <button class="btn" onclick="addToCart('Apple Smartphone', 49.99)">
          Add to Cart
        </button>
      </div>
    </div>

    <div class="cart" id="cart">
      <h2>Your Cart:</h2>
      <div id="cart-items"></div>
      <h3>Total: $<span id="cart-total">0.00</span></h3>
      <form id="checkout" action="">
        <button class="checkout-btn" type="button" value="" id="submit">
          Proceed to Checkout
        </button>
      </form>
    </div>

    <script>
      let cart = [];
      let totalValue = 0;

      function addToCart(productName, price) {
        cart.push({ name: productName, price: price });
        totalValue += price;

        updateCartDisplay();
        return cart;
      }

      function updateCartDisplay() {
        const cartContainer = document.getElementById("cart-items");
        cartContainer.innerHTML = "";

        cart.forEach((item, index) => {
          const cartItemElement = document.createElement("div");
          cartItemElement.classList.add("cart-item");
          cartItemElement.innerHTML = `
                <span>${item.name} - $${item.price.toFixed(2)}</span>
                <button onclick="removeFromCart(${index})">Remove</button>
            `;
          cartContainer.appendChild(cartItemElement);
        });

        document.getElementById("cart-total").textContent =
          totalValue.toFixed(2);

        document.getElementById("cart-total").value = totalValue.toFixed(2);

        var amount = document.getElementById("cart-total").textContent;
        const checkoutBtn = document.getElementById("submit");
        if (amount > 0) {
          checkoutBtn.disabled = false;
        } else {
          checkoutBtn.disabled = true;
        }
      }

      function removeFromCart(index) {
        totalValue -= cart[index].price;

        cart.splice(index, 1);

        updateCartDisplay();
      }

      function submitForm() {
        var amount = document.getElementById("cart-total").textContent;

        cart = JSON.stringify(cart);
        if (parseFloat(amount) > 0) {
          // Show SweetAlert confirmation before redirect
          Swal.fire({
            title: "Are you sure?",
            text:
              "You are about to proceed to the checkout with a total amount of $" +
              amount,
            icon: "warning",
            showCancelButton: true,
            confirmButtonColor: "#3085d6",
            cancelButtonColor: "#d33",
            confirmButtonText: "Yes, proceed to checkout",
            cancelButtonText: "Cancel",
          }).then((result) => {
            if (result.isConfirmed) {
              // Redirect to CheckoutForm.html with the amount as query parameter

              $.ajax({
                url: "session.php",
                method: "POST",
                data: {
                  amount,
                  cart,
                },
                success: function (response) {
                 
                  window.location.href = "form.php";
                },
              });
            }
          });
        } else {
          Swal.fire({
            title: "Invalid Cart",
            text: "The cart is empty or the amount is invalid.",
            icon: "error",
            confirmButtonText: "OK",
          });
        }
      }

      // var amount = document.getElementById("cart-total").textContent;
      // if (amount<=0) {
      //     $('.checkout-btn').prop('disabled',true);
      // }
      // else if (amount>0){
      //     $('.checkout-btn').prop('disabled',false);
      // }

      $(document).on("click", "#submit", function () {
        submitForm();
      });
    </script>
  </body>
</html>
